<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab Picks - Divot Lab</title>
<link rel="icon" type="image/png" href="/favicon.png">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --black: #0A0A0A;
  --white: #FAFAFA;
  --graphite: #4A4A4A;
  --green: #1B4D3E;
  --green-light: #5BBF85;
  --blue: #2C5F7C;
  --blue-mid: #5A8FA8;
  --red: #D94848;
  --body: 'DM Sans', system-ui, sans-serif;
  --mono: 'JetBrains Mono', 'Courier New', monospace;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: var(--body);
  background: var(--black);
  color: var(--white);
  min-height: 100vh;
}

/* HERO SECTION */
.lab-picks-hero {
  min-height: 50vh;
  background: linear-gradient(165deg, #0a0a0a 0%, #0d1612 100%);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 100px 56px 80px;
  overflow: hidden;
  margin-bottom: 48px;
}
.lab-picks-hero::before {
  content:'';
  position:absolute;
  top:50%; left:50%; transform:translate(-50%,-50%);
  width:600px; height:600px;
  background:radial-gradient(ellipse at center, rgba(27,77,62,.12) 0%, transparent 65%);
  pointer-events:none;
}
.hero-content {
  position: relative;
  z-index: 1;
  text-align: center;
  max-width: 680px;
}
.hero-eyebrow {
  font-size: 11px;
  font-weight: 500;
  letter-spacing: .24em;
  text-transform: uppercase;
  color: var(--green-light);
  margin-bottom: 24px;
  opacity: 0.8;
}
.hero-title {
  font-size: clamp(48px, 7vw, 72px);
  font-weight: 700;
  letter-spacing: -.025em;
  line-height: 1.02;
  color: var(--white);
  margin-bottom: 18px;
}
.hero-subtitle {
  font-size: 18px;
  font-weight: 300;
  color: rgba(250,250,250,0.5);
  line-height: 1.6;
}

/* LOGIN WALL */
#loginWall {
  position: fixed;
  inset: 0;
  background: rgba(10,10,10,0.98);
  backdrop-filter: blur(12px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
#loginWall.hidden { display: none; }

.login-box {
  background: #111;
  border: 1px solid #1a1a1a;
  border-radius: 12px;
  padding: 48px 40px;
  max-width: 420px;
  width: 90%;
  text-align: center;
}
.login-logo {
  width: 48px;
  height: 48px;
  margin: 0 auto 24px;
  color: var(--green-light);
}
.login-title {
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 8px;
  letter-spacing: -0.02em;
}
.login-subtitle {
  font-size: 14px;
  color: rgba(250,250,250,0.4);
  margin-bottom: 32px;
}
.login-input {
  width: 100%;
  background: rgba(250,250,250,0.05);
  border: 1px solid rgba(250,250,250,0.1);
  border-radius: 8px;
  padding: 14px 18px;
  font-family: var(--mono);
  font-size: 15px;
  color: var(--white);
  margin-bottom: 16px;
  transition: all 0.2s;
}
.login-input:focus {
  outline: none;
  border-color: var(--green-light);
  background: rgba(250,250,250,0.08);
}
.login-btn {
  width: 100%;
  background: linear-gradient(135deg, var(--green), var(--green-light));
  border: none;
  border-radius: 8px;
  padding: 14px;
  font-family: var(--body);
  font-size: 15px;
  font-weight: 600;
  color: white;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}
.login-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 24px rgba(91,191,133,0.25);
}
.login-error {
  color: var(--red);
  font-size: 13px;
  margin-top: 12px;
  display: none;
}
.login-error.show { display: block; }

/* MAIN APP */
#app {
  display: none;
}
#app.show { display: block; }

/* CONTENT SECTION */
.content-section {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 24px 48px;
}

/* HEADER */
.app-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 32px;
  padding-bottom: 24px;
  border-bottom: 1px solid rgba(250,250,250,0.1);
}
.app-title {
  font-size: 32px;
  font-weight: 700;
  letter-spacing: -0.02em;
}
.app-title span {
  color: var(--green-light);
  font-weight: 400;
}
.app-meta {
  display: flex;
  align-items: center;
  gap: 20px;
  font-size: 13px;
  color: rgba(250,250,250,0.5);
}
.refresh-btn {
  background: rgba(250,250,250,0.05);
  border: 1px solid rgba(250,250,250,0.1);
  border-radius: 6px;
  padding: 8px 16px;
  font-family: var(--body);
  font-size: 13px;
  font-weight: 500;
  color: var(--white);
  cursor: pointer;
  transition: all 0.2s;
}
.refresh-btn:hover {
  background: rgba(250,250,250,0.08);
  border-color: var(--green-light);
}

/* TABS */
.tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 24px;
  border-bottom: 1px solid rgba(250,250,250,0.1);
  padding-bottom: 2px;
}
.tab {
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  padding: 12px 20px;
  font-family: var(--body);
  font-size: 14px;
  font-weight: 500;
  color: rgba(250,250,250,0.5);
  cursor: pointer;
  transition: all 0.2s;
}
.tab:hover {
  color: rgba(250,250,250,0.8);
}
.tab.active {
  color: var(--green-light);
  border-bottom-color: var(--green-light);
}

/* TAB CONTENT */
.tab-content {
  display: none;
}
.tab-content.active {
  display: block;
}

/* LOADING */
.loading {
  text-align: center;
  padding: 60px 20px;
  color: rgba(250,250,250,0.4);
}

/* VALUE TABLE */
.value-table {
  background: #111;
  border: 1px solid #1a1a1a;
  border-radius: 12px;
  overflow: hidden;
}
.value-table table {
  width: 100%;
  border-collapse: collapse;
}
.value-table thead {
  background: rgba(250,250,250,0.03);
  border-bottom: 1px solid rgba(250,250,250,0.1);
}
.value-table th {
  padding: 14px 16px;
  text-align: left;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: rgba(250,250,250,0.4);
}
.value-table th.right { text-align: right; }
.value-table th.center { text-align: center; }
.value-table tbody tr {
  border-bottom: 1px solid rgba(250,250,250,0.05);
  transition: background 0.15s;
}
.value-table tbody tr:hover {
  background: rgba(250,250,250,0.02);
}
.value-table tbody tr.high-value {
  background: rgba(91,191,133,0.05);
}
.value-table tbody tr.high-value:hover {
  background: rgba(91,191,133,0.08);
}
.value-table td {
  padding: 14px 16px;
  font-size: 14px;
}
.player-name {
  font-weight: 500;
  color: rgba(250,250,250,0.9);
}
.market-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}
.market-badge.win { background: rgba(91,191,133,0.15); color: var(--green-light); }
.market-badge.top5 { background: rgba(90,143,168,0.15); color: var(--blue-mid); }
.market-badge.top10 { background: rgba(90,143,168,0.12); color: var(--blue-mid); }
.market-badge.top20 { background: rgba(90,143,168,0.1); color: var(--blue-mid); }
.odds-cell {
  font-family: var(--mono);
  font-size: 13px;
  color: rgba(250,250,250,0.6);
  text-align: center;
}
.odds-cell.best {
  color: var(--green-light);
  font-weight: 600;
}
.odds-cell.dg {
  color: var(--blue-mid);
  font-weight: 600;
}
.edge-cell {
  font-family: var(--mono);
  font-size: 14px;
  font-weight: 600;
  text-align: right;
}
.edge-positive { color: var(--green-light); }
.edge-medium { color: var(--blue-mid); }
.confidence-badge {
  display: inline-block;
  padding: 5px 10px;
  border-radius: 5px;
  font-size: 12px;
  font-weight: 600;
  text-align: center;
  min-width: 80px;
}
.confidence-badge.strong {
  background: rgba(91,191,133,0.15);
  color: var(--green-light);
  border: 1px solid rgba(91,191,133,0.3);
}
.confidence-badge.moderate {
  background: rgba(90,143,168,0.15);
  color: var(--blue-mid);
  border: 1px solid rgba(90,143,168,0.3);
}

/* STATS GRID */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}
.stat-card {
  background: #111;
  border: 1px solid #1a1a1a;
  border-radius: 12px;
  padding: 20px;
}
.stat-label {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: rgba(250,250,250,0.4);
  margin-bottom: 8px;
}
.stat-value {
  font-family: var(--mono);
  font-size: 28px;
  font-weight: 600;
  color: var(--green-light);
}

/* EMPTY STATE */
.empty-state {
  text-align: center;
  padding: 80px 20px;
  color: rgba(250,250,250,0.4);
}
.empty-icon {
  font-size: 64px;
  margin-bottom: 16px;
  opacity: 0.3;
}

@media (max-width: 768px) {
  .lab-picks-hero { min-height: 40vh; padding: 80px 22px 60px; }
  .content-section { padding: 0 16px 48px; }
  .tabs { overflow-x: auto; }
  .value-table { overflow-x: auto; }
  .stats-grid { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<!-- LOGIN WALL -->
<div id="loginWall">
  <div class="login-box">
    <svg class="login-logo" viewBox="0 0 72 72" fill="none">
      <line x1="4" y1="36.5" x2="68" y2="36.5" stroke="currentColor" stroke-width="3.2"/>
      <path d="M10 36.5 C18 36.5,26 60.5,36 60.5 S54 36.5,62 36.5" fill="currentColor" fill-opacity=".15"/>
      <path d="M10 36.5 C18 36.5,26 60.5,36 60.5 S54 36.5,62 36.5" stroke="currentColor" stroke-width="2.8" fill="none"/>
      <circle cx="36" cy="20.5" r="9" fill="currentColor"/>
    </svg>
    <h1 class="login-title">Lab Picks</h1>
    <p class="login-subtitle">Private betting intelligence</p>
    <form id="loginForm">
      <input type="password" id="passwordInput" class="login-input" placeholder="Enter password" required>
      <button type="submit" class="login-btn">Access Lab Picks</button>
    </form>
    <div id="loginError" class="login-error">Invalid password</div>
  </div>
</div>

<!-- MAIN APP -->
<div id="app">
  <!-- HERO SECTION -->
  <section class="lab-picks-hero">
    <div class="hero-content">
      <div class="hero-eyebrow">Private Tool</div>
      <h1 class="hero-title">Lab Picks</h1>
      <p class="hero-subtitle">Betting intelligence powered by DataGolf analytics</p>
    </div>
  </section>

  <!-- CONTENT SECTION -->
  <div class="content-section">
    <div class="app-meta" style="text-align: right; margin-bottom: 24px; font-size: 13px; color: rgba(250,250,250,0.5);">
      <span id="lastUpdate">Loading...</span>
      <button class="refresh-btn" onclick="refreshData()" style="margin-left: 12px;">‚ü≥ Refresh</button>
    </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab active" data-tab="value-finder">Value Finder</button>
    <button class="tab" data-tab="live-tracker">Live Tracker</button>
    <button class="tab" data-tab="summary">Summary</button>
  </div>

  <!-- TAB 1: VALUE FINDER -->
  <div id="value-finder" class="tab-content active">
    <div class="stats-grid" id="summaryStats">
      <div class="stat-card">
        <div class="stat-label">Total Value Bets</div>
        <div class="stat-value" id="totalBets">--</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg Edge</div>
        <div class="stat-value" id="avgEdge">--</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Strong Picks</div>
        <div class="stat-value" id="strongPicks">--</div>
      </div>
    </div>

    <div id="valueTableContainer" class="loading">
      Finding value bets...
    </div>
  </div>

  <!-- TAB 2: LIVE TRACKER -->
  <div id="live-tracker" class="tab-content">
    <div id="liveContainer" class="loading">
      Loading live data...
    </div>
  </div>

  <!-- TAB 3: SUMMARY -->
  <div id="summary" class="tab-content">
    <div id="summaryContainer" class="loading">
      Loading summary...
    </div>
  </div>
  
  </div> <!-- End content-section -->
</div> <!-- End app -->

<script>
const API_BASE = 'https://divotlab-api.vercel.app';
const MIN_EDGE_OUTRIGHT = 0.08; // 8%
const MIN_EDGE_STRONG = 0.15; // 15%

let authenticated = false;
let globalBettingData = null;
let isLiveTournament = false;

// ============================================
// HELPER FUNCTIONS
// ============================================

function decimalToAmerican(decimal) {
  if (decimal >= 2) {
    return '+' + Math.round((decimal - 1) * 100);
  } else {
    return Math.round(-100 / (decimal - 1));
  }
}

function formatOdds(decimal) {
  // Show both formats for clarity
  const american = decimalToAmerican(decimal);
  return `${american} (${decimal.toFixed(1)})`;
}

// ============================================
// AUTHENTICATION
// ============================================

document.getElementById('loginForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const password = document.getElementById('passwordInput').value;
  const errorEl = document.getElementById('loginError');
  
  try {
    const response = await fetch(`${API_BASE}/api/auth/lab-picks`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ password })
    });
    
    const data = await response.json();
    
    if (data.success) {
      authenticated = true;
      document.getElementById('loginWall').classList.add('hidden');
      document.getElementById('app').classList.add('show');
      loadAllData();
    } else {
      errorEl.classList.add('show');
      setTimeout(() => errorEl.classList.remove('show'), 3000);
    }
  } catch (error) {
    console.error('Auth error:', error);
    errorEl.textContent = 'Connection error';
    errorEl.classList.add('show');
  }
});

// ============================================
// TAB SWITCHING
// ============================================

document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    const targetTab = tab.dataset.tab;
    
    // Update tab buttons
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    
    // Update tab content
    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
    document.getElementById(targetTab).classList.add('active');
  });
});

// ============================================
// DATA LOADING
// ============================================

async function loadAllData() {
  try {
    await Promise.all([
      loadValueBets(),
      loadLiveData(),
      loadSummary()
    ]);
    
    document.getElementById('lastUpdate').textContent = `Updated: ${new Date().toLocaleTimeString()}`;
  } catch (error) {
    console.error('Error loading data:', error);
  }
}

async function loadValueBets() {
  const container = document.getElementById('valueTableContainer');
  container.innerHTML = '<div class="loading">Finding value bets...</div>';
  
  try {
    // Fetch Win, Top 5, Top 10, Top 20 in parallel
    const [win, top5, top10, top20] = await Promise.all([
      fetch(`${API_BASE}/api/betting-odds?tour=pga&market=win&odds_format=decimal`).then(r => r.json()),
      fetch(`${API_BASE}/api/betting-odds?tour=pga&market=top_5&odds_format=decimal`).then(r => r.json()),
      fetch(`${API_BASE}/api/betting-odds?tour=pga&market=top_10&odds_format=decimal`).then(r => r.json()),
      fetch(`${API_BASE}/api/betting-odds?tour=pga&market=top_20&odds_format=decimal`).then(r => r.json())
    ]);
    
    const valueBets = [];
    
    // Process each market
    processMarket(win.data, 'win', valueBets);
    processMarket(top5.data, 'top5', valueBets);
    processMarket(top10.data, 'top10', valueBets);
    processMarket(top20.data, 'top20', valueBets);
    
    // Sort by edge descending
    valueBets.sort((a, b) => b.edge - a.edge);
    
    globalBettingData = valueBets;
    renderValueTable(valueBets);
    updateSummaryStats(valueBets);
    
  } catch (error) {
    console.error('Error loading value bets:', error);
    container.innerHTML = '<div class="empty-state"><div class="empty-icon">‚ö†</div><p>Error loading betting data</p></div>';
  }
}

function processMarket(data, market, valueBets) {
  if (!data || !data.odds) return;
  
  // Check if tournament is live (baseline model unavailable)
  if (data.notes && data.notes.includes('Tournament is live')) {
    isLiveTournament = true;
  }
  
  data.odds.forEach(player => {
    const dgOdds = player.datagolf?.baseline_history_fit;
    
    // Skip players without DG model data
    if (!dgOdds || dgOdds === null) return;
    
    const dgProb = 1 / dgOdds;
    
    // Find best book odds
    const books = ['draftkings', 'fanduel', 'betmgm', 'pinnacle', 'bet365', 'caesars'];
    let bestOdds = 0;
    let bestBook = '';
    
    books.forEach(book => {
      if (player[book] && player[book] > bestOdds) {
        bestOdds = player[book];
        bestBook = book;
      }
    });
    
    if (bestOdds === 0) return;
    
    // Calculate edge
    const edge = (dgProb * bestOdds) - 1;
    const edgePercent = edge * 100;
    
    // Filter by minimum edge
    if (edge < MIN_EDGE_OUTRIGHT) return;
    
    // Determine confidence
    let confidence = 'moderate';
    if (edge >= MIN_EDGE_STRONG) confidence = 'strong';
    
    valueBets.push({
      player: player.player_name,
      market,
      dgOdds: dgOdds,
      dgOddsFormatted: formatOdds(dgOdds),
      bestOdds: bestOdds,
      bestOddsFormatted: formatOdds(bestOdds),
      bestBook,
      edge,
      edgePercent: edgePercent.toFixed(1),
      confidence
    });
  });
}

function renderValueTable(valueBets) {
  const container = document.getElementById('valueTableContainer');
  
  if (valueBets.length === 0) {
    if (isLiveTournament) {
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">üèåÔ∏è</div>
          <p><strong>Tournament is Live</strong></p>
          <p style="margin-top: 12px; font-size: 14px;">DataGolf baseline model is unavailable during live play.<br>Value betting is best done pre-tournament.</p>
        </div>
      `;
    } else {
      container.innerHTML = '<div class="empty-state"><div class="empty-icon">üí∞</div><p>No value bets found at current thresholds</p></div>';
    }
    return;
  }
  
  container.innerHTML = `
    <div class="value-table">
      <table>
        <thead>
          <tr>
            <th>Player</th>
            <th>Market</th>
            <th class="center">DG Model Odds</th>
            <th class="center">Best Book</th>
            <th class="center">Book Odds</th>
            <th class="right">Edge</th>
            <th class="right">Confidence</th>
          </tr>
        </thead>
        <tbody>
          ${valueBets.map(bet => `
            <tr class="${bet.confidence === 'strong' ? 'high-value' : ''}">
              <td class="player-name">${bet.player}</td>
              <td><span class="market-badge ${bet.market}">${bet.market.toUpperCase()}</span></td>
              <td class="odds-cell dg">${bet.dgOddsFormatted}</td>
              <td class="odds-cell">${bet.bestBook.toUpperCase()}</td>
              <td class="odds-cell best">${bet.bestOddsFormatted}</td>
              <td class="edge-cell edge-${bet.confidence === 'strong' ? 'positive' : 'medium'}">+${bet.edgePercent}%</td>
              <td class="right"><span class="confidence-badge ${bet.confidence}">${bet.confidence.toUpperCase()}</span></td>
            </tr>
          `).join('')}
        </tbody>
      </table>
    </div>
    ${isLiveTournament ? '<div style="margin-top: 16px; padding: 16px; background: rgba(217,72,72,0.1); border: 1px solid rgba(217,72,72,0.3); border-radius: 8px; font-size: 13px; color: rgba(250,250,250,0.7);"><strong>‚ö† Tournament is Live:</strong> These odds may be stale. DG model uses historical fit during live play.</div>' : ''}
  `;
}

function updateSummaryStats(valueBets) {
  const total = valueBets.length;
  const avgEdge = valueBets.reduce((sum, bet) => sum + bet.edge, 0) / total;
  const strong = valueBets.filter(bet => bet.confidence === 'strong').length;
  
  document.getElementById('totalBets').textContent = total;
  document.getElementById('avgEdge').textContent = `${(avgEdge * 100).toFixed(1)}%`;
  document.getElementById('strongPicks').textContent = strong;
}

async function loadLiveData() {
  const container = document.getElementById('liveContainer');
  
  try {
    const response = await fetch(`${API_BASE}/api/live-tournament?tour=pga&odds_format=decimal`);
    const data = await response.json();
    
    if (data.success && data.data && data.data.event_name) {
      // Tournament exists and is live
      container.innerHTML = `
        <div class="stat-card" style="max-width: 600px; margin: 0 auto;">
          <div class="stat-label">Live Tournament</div>
          <h2 style="font-size: 24px; margin: 16px 0; color: var(--white);">${data.data.event_name}</h2>
          <p style="font-size: 14px; color: rgba(250,250,250,0.6);">Live predictions and tracking coming soon</p>
        </div>
      `;
    } else {
      container.innerHTML = '<div class="empty-state"><div class="empty-icon">‚è≥</div><p>No live tournament currently</p></div>';
    }
  } catch (error) {
    console.error('Live data error:', error);
    container.innerHTML = '<div class="empty-state"><div class="empty-icon">‚ö†</div><p>Error loading live data</p></div>';
  }
}

async function loadSummary() {
  const container = document.getElementById('summaryContainer');
  
  // Wait for betting data to load first
  if (!globalBettingData) {
    setTimeout(loadSummary, 1000);
    return;
  }
  
  if (globalBettingData.length === 0) {
    container.innerHTML = '<div class="empty-state"><div class="empty-icon">üìä</div><p>No value bets to summarize</p></div>';
    return;
  }
  
  const byMarket = globalBettingData.reduce((acc, bet) => {
    if (!acc[bet.market]) acc[bet.market] = [];
    acc[bet.market].push(bet);
    return acc;
  }, {});
  
  const marketNames = {
    'win': 'Win',
    'top5': 'Top 5',
    'top10': 'Top 10',
    'top20': 'Top 20'
  };
  
  container.innerHTML = `
    <div class="stats-grid">
      ${Object.keys(byMarket).map(market => {
        const avgEdge = byMarket[market].reduce((sum, bet) => sum + bet.edge, 0) / byMarket[market].length;
        return `
          <div class="stat-card">
            <div class="stat-label">${marketNames[market] || market.toUpperCase()}</div>
            <div class="stat-value">${byMarket[market].length}</div>
            <div style="font-size: 13px; color: rgba(250,250,250,0.5); margin-top: 8px;">
              Avg Edge: ${(avgEdge * 100).toFixed(1)}%
            </div>
          </div>
        `;
      }).join('')}
    </div>
    
    <div style="margin-top: 32px;">
      <h3 style="font-size: 18px; margin-bottom: 16px; color: var(--green-light);">Top 5 Value Bets</h3>
      <div class="value-table">
        <table>
          <thead>
            <tr>
              <th>Player</th>
              <th>Market</th>
              <th class="right">Edge</th>
            </tr>
          </thead>
          <tbody>
            ${globalBettingData.slice(0, 5).map(bet => `
              <tr>
                <td class="player-name">${bet.player}</td>
                <td><span class="market-badge ${bet.market}">${bet.market.toUpperCase()}</span></td>
                <td class="edge-cell edge-positive">+${bet.edgePercent}%</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      </div>
    </div>
  `;
}

function refreshData() {
  if (!authenticated) return;
  loadAllData();
}
</script>

</body>
</html>